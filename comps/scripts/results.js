(function(){
    window.results2025 = window.results2025 || {
        top10: [
            { rank: 1, name: 'Kamlesh Gopinath', thumb: 'images/winners/place1.png', abstract: 'https://pastequest.com/?d180cb48c06539e6#9ttRNrLiZR99ju5qcdUafEe5f9qy48kr9fmCcp6XPZQe', project: 'https://www.canva.com/design/DAG1JF4ajcI/3C1to9TbEL2Dk-T24Vgjow/edit?utm_content=DAG1JF4ajcI&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton' },
            { rank: 2, name: 'Serene Joo', thumb: 'images/winners/place2.png', abstract: 'https://pastequest.com/?72aa12b56aea758a#AVmdLBqHxvSniKYzFEwC4FXUT33XrPbpjnCeEHtE1nLf', project: 'https://drive.google.com/file/d/1ABQRk_p-tZ3B5nJDhASo87t4qz6sc06s/view?usp=sharing' },
            { rank: 3, name: 'Parth Pattani', thumb: 'images/winners/place3.png', abstract: 'https://pastequest.com/?aa7c8b476fdab4cf#BEqFLxMC36sFRs9oWb8TbgXJHhcBxcRECLoGdJxAysJg', project: 'https://docs.google.com/presentation/d/1Qr4vcw6ctXfAfjhIGKWb6wCXmnTPRdJ8s5A1vaGMq6U/edit?usp=sharing' },
            { rank: 4, name: 'Conrad Woodhatch-Stuart', thumb: 'images/winners/place4.png', abstract: 'https://pastequest.com/?4cfd8d82277db2b5#4BX5mZqFfhFZ1ycJUE62YQHA9gcs5ptxeyhVDuCiRcM6', project: 'https://gamma.app/docs/Automating-the-Future-of-Food-Security-A-Low-Cost-Robotics-Soluti-2whwi4a1tmpyiek' },
            { rank: 5, name: 'Daniel Jennings', thumb: 'images/winners/place5.png', abstract: 'https://pastequest.com/?c933d4320838c5b3#5j3GGiGeXaXxXEW29Uudcyqrb88dV1VpAatcgaE2uyCC', project: 'https://docs.google.com/presentation/d/1Yudm4JXSlVNmbScpQ_DV3ZlCdEG6yzNJ7R-_n-884Mc/edit?usp=sharing' },
            { rank: 6, name: 'Ajitesh Narasimhan', thumb: 'images/winners/place6.png', abstract: 'https://pastequest.com/?5e92f2459cc7b4b6#6sLvGbwb3vrgDNRSPiJrpRVZPLB6ybamJybE5GvhDDhz', project: 'https://drive.google.com/drive/folders/1MewQ1_8BzueREThNkBhyWk-3YgDjO7ZU?usp=sharing' },
            { rank: 7, name: 'Devin Talwar', thumb: 'images/winners/place7.png', abstract: 'https://pastequest.com/?121736a8f66028f7#UjJQY7QtkYxoYWQgcKQ5pispbAGuxV2Vjj9hCkH4LKo', project: 'https://drive.google.com/file/d/1YeUxR2sG8snNlhbWEKLIOhsZ__WMSTiQ/view?usp=sharing' },
            { rank: 8, name: 'Dhruvi Parekh', thumb: 'images/winners/place8.png', abstract: 'https://pastequest.com/?557c652d936a8f54#FdeSKEsPKhSAKuCo7Ei8VkkUQvivZwgrLS1DSaBuoM28', project: 'https://drive.google.com/file/d/1zi4n8LOE0czz5DcObV0YaqBDUBSL6m1E/view?usp=drivesdk' },
            { rank: 9, name: 'Mikayla Pasquel', thumb: 'images/winners/place9.png', abstract: 'https://pastequest.com/?32b7fa922b0c5b58#H2Trhi2qf1WZ2asa9geWDRpbFskjeC2u8x8TnhNeHWNf', project: 'https://docs.google.com/presentation/d/1GgYx9fXqTeyVk3v4qdaG8lWWs5hQvcKe/edit?usp=sharing&ouid=108414043718768096377&rtpof=true&sd=true' },
            { rank: 10, name: 'Soham Ghosh', thumb: 'images/winners/place10.png', abstract: 'https://pastequest.com/?856055073f764cfd#46Vfj9BHm5NYULAVg3QpEdPyZsgDtUSAQpz9boVMbAbm', project: 'https://drive.google.com/file/d/1b7DmHKf3iD06ddoQpLQcNAeY5PHkRmnH/view?usp=sharing' }
        ],
        specialAwards: [
            { award: 'Best Presented', winner: 'Daniel Jennings', link: 'https://docs.google.com/presentation/d/1Yudm4JXSlVNmbScpQ_DV3ZlCdEG6yzNJ7R-_n-884Mc/edit?usp=sharing' },
            { award: 'Best Researched', winner: 'Serene Joo', link: 'https://drive.google.com/file/d/1ABQRk_p-tZ3B5nJDhASo87t4qz6sc06s/view?usp=sharing' },
            { award: 'Most Innovative', winner: 'Kamlesh Gopinath', link: 'https://www.canva.com/design/DAG1JF4ajcI/3C1to9TbEL2Dk-T24Vgjow/edit?utm_content=DAG1JF4ajcI&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton' },
            { award: 'Most Technical', winner: 'Parth Pattani', link: 'https://docs.google.com/presentation/d/1Qr4vcw6ctXfAfjhIGKWb6wCXmnTPRdJ8s5A1vaGMq6U/edit?usp=sharing' }
        ],
        honorableMentions: [
            { name: 'HM1: Vivaan Singh', abstract: 'https://pastequest.com/?cf4ee3c4e1017b3d#CGaG4RoVRzP8jwMGUJp6kf8W33R5gZQj5T4UTcTJMkM1', project: 'https://docs.google.com/presentation/d/1Azxl1o8LJv5gD_xJ-PchIWPfwOp6BN8Ghko8EZ7Wa0A/edit?slide=id.p9#slide=id.p9' },
            { name: 'HM2: Gunjot Singh Sahni', abstract: 'https://pastequest.com/?cf4ee3c4e1017b3d#CGaG4RoVRzP8jwMGUJp6kf8W33R5gZQj5T4UTcTJMkM1', project: 'https://drive.google.com/file/d/1P1knb3veUMqdj0YM9Sox17Su_PyoTweB/view?usp=sharing' },
            { name: 'HM3: Julia de Oliveira Leite', abstract: 'https://pastequest.com/?c9047e5a8a347b19#CuwChfii3vW5wodHvhH2yH3hptXNBk3JKjPGDuqkTEX6', project: 'https://drive.google.com/file/d/1wEsw_NoECmEHYZzJz25ClfvQXZKHi4iY/view?usp=sharing' },
        ]
    };

    function injectStyles(){
        const css = `
            .top10-container { position: relative; }
            .top10-scroll { overflow-x:auto; -webkit-overflow-scrolling:touch; scroll-snap-type:x mandatory; padding-bottom:8px; }
            #top10-list { display:flex; gap:1rem; padding:8px 6px; align-items:flex-start; }

            .results-top10-card { flex:0 0 360px; scroll-snap-align:center; background:#fff; border-radius:12px; box-shadow:0 12px 40px rgba(0,0,0,0.08); display:flex; flex-direction:column; overflow:hidden; transition:transform .18s ease, box-shadow .18s ease; }
            .results-top10-card:hover { transform:translateY(-8px); box-shadow:0 18px 48px rgba(0,0,0,0.14); }
            .results-top10-card:focus { outline:3px solid rgba(13,110,253,0.12); }

            .results-thumb { width:100%; height:280px; background:#f8f8f8; display:block; position:relative; align-items:center; justify-content:center; }
            .results-thumb img { width:100%; height:100%; object-fit:contain; object-position:center center; display:block; background:transparent; }

            .rank-badge { position:absolute; left:12px; top:12px; background:rgba(0,0,0,0.7); color:#fff; min-width:48px; height:48px; border-radius:999px; display:flex; align-items:center; justify-content:center; font-weight:800; font-size:1.05rem; padding:0 8px; box-shadow:0 6px 16px rgba(0,0,0,0.18);} 

            .results-content { padding:14px 18px 18px; display:flex; flex-direction:column; gap:8px; }
            .results-meta .title { font-weight:800; font-size:1.15rem; line-height:1.15; }
            .results-meta .sub { color:#666; font-size:0.95rem; }
            .results-meta .links { margin-top:8px; font-size:1rem; }
            .results-meta .links a { color:var(--bs-primary,#0d6efd); text-decoration:none; font-weight:600 }
            .results-meta .links a:hover { text-decoration:underline; }

            .results-award-card { background: linear-gradient(180deg, #ffffff, #fbfbff); padding:18px; border-radius:12px; border-left:6px solid rgba(13,110,253,0.12); box-shadow:0 10px 30px rgba(13,110,253,0.04); transition:transform .18s ease, box-shadow .18s ease; }
            .results-award-card:hover { transform:translateY(-6px); box-shadow:0 16px 44px rgba(13,110,253,0.08); }
            .results-award-card .award-title { font-weight:800; }
            .results-award-card .award-winner { margin-top:8px; font-weight:600; color:var(--bs-primary,#0d6efd); }

            .results-honour-card { background:#fff; padding:14px; border-radius:10px; border:1px solid rgba(0,0,0,0.04); box-shadow:0 8px 28px rgba(0,0,0,0.03); transition:transform .12s ease; }
            .results-honour-card:hover { transform:translateY(-4px); box-shadow:0 12px 32px rgba(0,0,0,0.06); }
            .results-honour-card .honour-name { font-weight:700; }

            @media (max-width:1100px){ .results-top10-card { flex:0 0 320px; } .results-thumb { height:240px; } }
            @media (max-width:800px){ .results-top10-card { flex:0 0 300px; } .results-thumb { height:200px; } .top10-nav{ width:36px;height:36px;} }
            @media (max-width:520px){ #top10-list { gap:0.6rem; } .results-top10-card{ flex:0 0 240px;} .results-thumb{ height:160px;} }
        `;
        const style = document.createElement('style');
        style.setAttribute('data-generated','results-comps-css');
        style.appendChild(document.createTextNode(css));
        document.head.appendChild(style);
    }

    function createCard(item){
        const card = document.createElement('article');
        card.className = 'results-top10-card';
        card.setAttribute('tabindex','0');
        card.setAttribute('role','group');

        const thumbWrap = document.createElement('div');
        thumbWrap.className = 'results-thumb';

        const badge = document.createElement('div');
        badge.className = 'rank-badge';
        badge.textContent = item.rank || '';
        thumbWrap.appendChild(badge);

        const img = document.createElement('img');
        img.src = item.thumb;
        img.alt = (item.name || 'Entry') + ' thumbnail';
        img.loading = 'lazy';
        thumbWrap.appendChild(img);

        const content = document.createElement('div');
        content.className = 'results-content';

        const meta = document.createElement('div');
        meta.className = 'results-meta';

        const title = document.createElement('div');
        title.className = 'title';
        title.textContent = (item.rank ? item.rank + '. ' : '') + (item.name || 'Unnamed');

        const sub = document.createElement('div');
        sub.className = 'sub';
        sub.textContent = item.sub || '';

        const links = document.createElement('div');
        links.className = 'links';
        const a1 = document.createElement('a'); a1.href = item.abstract || '#'; a1.target = '_blank'; a1.rel='noopener'; a1.textContent = 'Abstract'; a1.setAttribute('aria-label','View abstract for ' + (item.name||'entry'));
        const sep = document.createTextNode(' \u00A0|\u00A0 ');
        const a2 = document.createElement('a'); a2.href = item.project || '#'; a2.target = '_blank'; a2.rel='noopener'; a2.textContent = 'Project'; a2.setAttribute('aria-label','View project for ' + (item.name||'entry'));
        links.appendChild(a1); links.appendChild(sep); links.appendChild(a2);

        meta.appendChild(title);
        if(sub.textContent) meta.appendChild(sub);
        content.appendChild(meta);
        content.appendChild(links);

        card.appendChild(thumbWrap);
        card.appendChild(content);

        return card;
    }

    function render(){
        const top10List = document.getElementById('top10-list');
        const top10Container = document.querySelector('.top10-container');
        if(top10List && window.results2025 && Array.isArray(window.results2025.top10)){
            top10List.innerHTML = '';
            window.results2025.top10.forEach(item => {
                const c = createCard(item);
                top10List.appendChild(c);
            });
        }

        if(top10Container){
            const parent = top10Container.parentNode;
            if(parent){
                function positionNavButtons(){
                    const left = parent.querySelector('button[data-results-nav="left"]');
                    const right = parent.querySelector('button[data-results-nav="right"]');
                    if(!top10Container) return;
                    const containerRect = top10Container.getBoundingClientRect();
                    const parentRect = parent.getBoundingClientRect();
                    if(getComputedStyle(parent).position === 'static') parent.style.position = 'relative';
                    const centerY = containerRect.top - parentRect.top + (containerRect.height / 2);
                    const btnOffset = 12;
                    const estimatedBtnW = 44;
                    const btnW = (left && left.getBoundingClientRect) ? (left.getBoundingClientRect().width || estimatedBtnW) : estimatedBtnW;
                    const leftPos = containerRect.left - parentRect.left - (btnW + btnOffset);
                    const rightPos = containerRect.right - parentRect.left + btnOffset;
                    if(left){
                        left.style.position = 'absolute';
                        left.style.top = centerY + 'px';
                        left.style.transform = 'translateY(-50%)';
                        left.style.left = Math.round(leftPos) + 'px';
                        left.style.right = '';
                    }
                    if(right){
                        right.style.position = 'absolute';
                        right.style.top = centerY + 'px';
                        right.style.transform = 'translateY(-50%)';
                        right.style.left = Math.round(rightPos) + 'px';
                        right.style.right = '';
                    }
                 }

                if(!parent.__results_nav_listeners){
                    window.addEventListener('resize', positionNavButtons);
                    window.addEventListener('scroll', positionNavButtons, { passive: true });
                    parent.__results_nav_listeners = true;
                }

                if(!parent.querySelector('button[data-results-nav="left"]')){
                    const leftBtn = document.createElement('button');
                    leftBtn.setAttribute('data-results-nav','left');
                    leftBtn.className = 'judges-scroll judges-scroll-left';
                    leftBtn.setAttribute('aria-label','Scroll submissions left');
                    leftBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
                    leftBtn.addEventListener('click', ()=>{
                        const scroller = top10Container.querySelector('.top10-scroll');
                        const card = scroller.querySelector('.results-top10-card');
                        const gap = parseInt(getComputedStyle(scroller.querySelector('#top10-list')).gap) || 16;
                        const cardWidth = card ? card.getBoundingClientRect().width : 360;
                        scroller.scrollBy({ left: -(cardWidth + gap), behavior: 'smooth' });
                    });
                    parent.insertBefore(leftBtn, top10Container);
                    positionNavButtons();
                }

                if(!parent.querySelector('button[data-results-nav="right"]')){
                    const rightBtn = document.createElement('button');
                    rightBtn.setAttribute('data-results-nav','right');
                    rightBtn.className = 'judges-scroll judges-scroll-right';
                    rightBtn.setAttribute('aria-label','Scroll submissions right');
                    rightBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
                    rightBtn.addEventListener('click', ()=>{
                        const scroller = top10Container.querySelector('.top10-scroll');
                        const card = scroller.querySelector('.results-top10-card');
                        const gap = parseInt(getComputedStyle(scroller.querySelector('#top10-list')).gap) || 16;
                        const cardWidth = card ? card.getBoundingClientRect().width : 360;
                        scroller.scrollBy({ left: (cardWidth + gap), behavior: 'smooth' });
                    });
                    parent.insertBefore(rightBtn, top10Container.nextSibling);
                    positionNavButtons();
                }
            }
        }

        const awardsContainer = document.getElementById('special-awards-list');
        if(awardsContainer && window.results2025 && Array.isArray(window.results2025.specialAwards)){
            awardsContainer.innerHTML = '';
            window.results2025.specialAwards.forEach(a => {
                const d = document.createElement('div');
                d.className = 'results-award-card';
                d.innerHTML = `<div class="award-title">${a.award}</div><div class="award-winner"><a href="${a.link}" target="_blank" rel="noopener">${a.winner}</a></div>`;
                awardsContainer.appendChild(d);
            });
        }

        const honourableList = document.getElementById('honourable-list');
        if(honourableList && window.results2025 && Array.isArray(window.results2025.honorableMentions)){
            honourableList.innerHTML = '';
            window.results2025.honorableMentions.forEach(h => {
                const d = document.createElement('div');
                d.className = 'results-honour-card';
                d.innerHTML = `<div class="honour-name">${h.name}</div><div style="margin-top:6px;"><a href="${h.abstract}" target="_blank" rel="noopener">Abstract</a> &nbsp;|&nbsp; <a href="${h.project}" target="_blank" rel="noopener">Project</a></div>`;
                honourableList.appendChild(d);
            });
        }

        const scroller = document.querySelector('.top10-scroll');
        if(scroller){
            let isDown = false, startX, scrollLeft;
            scroller.addEventListener('mousedown', (e)=>{ isDown = true; scroller.classList.add('active'); startX = e.pageX - scroller.offsetLeft; scrollLeft = scroller.scrollLeft; e.preventDefault(); });
            scroller.addEventListener('mouseleave', ()=>{ isDown = false; scroller.classList.remove('active'); });
            scroller.addEventListener('mouseup', ()=>{ isDown = false; scroller.classList.remove('active'); });
            scroller.addEventListener('mousemove', (e)=>{ if(!isDown) return; e.preventDefault(); const x = e.pageX - scroller.offsetLeft; const walk = (x - startX); scroller.scrollLeft = scrollLeft - walk; });

            scroller.setAttribute('tabindex','0');
            scroller.addEventListener('keydown', (e)=>{
                const key = e.key;
                if(!['ArrowRight','ArrowLeft','Home','End','PageDown','PageUp'].includes(key)) return;
                e.preventDefault();
                const card = scroller.querySelector('.results-top10-card');
                const gap = 16;
                const cardWidth = card ? card.getBoundingClientRect().width : 360;
                if(key === 'ArrowRight' || key === 'PageDown') scroller.scrollBy({ left: cardWidth + gap, behavior: 'smooth' });
                if(key === 'ArrowLeft' || key === 'PageUp') scroller.scrollBy({ left: -(cardWidth + gap), behavior: 'smooth' });
                if(key === 'Home') scroller.scrollTo({ left: 0, behavior: 'smooth' });
                if(key === 'End') scroller.scrollTo({ left: scroller.scrollWidth, behavior: 'smooth' });
            });
        }
    }

    function ready(fn){ if(document.readyState !== 'loading') fn(); else document.addEventListener('DOMContentLoaded', fn); }
    ready(()=>{ injectStyles(); render(); });
})();